name = "jack-dispatch"
main = "src/index.ts"
compatibility_date = "2024-12-01"

# Routes for tenant and custom domain routing
# Tenant apps: {username}-{slug}.runjack.xyz
# Custom domains: SSL for SaaS routes here via fallback origin
# The */* pattern catches ALL traffic including custom hostnames
# DNS: Add A records for @ and * -> 192.0.2.1 (proxied) in runjack.xyz zone
routes = [
  { pattern = "*/*", zone_name = "runjack.xyz" }
]

[[kv_namespaces]]
binding = "PROJECTS_CACHE"
id = "1745e7c2b059484c81d39c694201d061"

[[dispatch_namespaces]]
binding = "TENANT_DISPATCH"
namespace = "jack-tenants"

# Analytics Engine for usage metering
# Writes data points per request for billing and analytics dashboard
[[analytics_engine_datasets]]
binding = "USAGE"
dataset = "jack_usage"
